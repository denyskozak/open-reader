# Open Reader Telegram Mini App

Open Reader — демо-приложение книжного каталога для Telegram Mini Apps. В нём реализованы экраны категорий, списка книг и карточки произведения, а также поиск, фильтры, бесконечная подгрузка и список отзывов. Приложение использует React 18, TypeScript, React Router 6, официальный Telegram SDK и компонентную библиотеку @telegram-apps/telegram-ui.

## Возможности

- Инициализация Mini App через `@telegram-apps/sdk-react`, поддержка BackButton/MainButton и динамических тем Telegram.
- Главная страница с сеткой категорий, строкой поиска и состояниями загрузки/ошибки/пустого результата.
- Экран категории с фильтрами (сортировка, поиск, выбор тегов), бесконечной прокруткой и скелетонами.
- Страница книги с обложкой, рейтингом, описанием, отзывами, блоком «Похожие» и MainButton «Читать/Купить».
- Заглушка подключения TON-кошелька на базе `@tonconnect/ui-react`.
- In-memory API c мок-данными (45 книг, 8 категорий, отзывы) и случайной задержкой 300–600 мс.
- Тосты, баннеры ошибок, пустые состояния и поддержка светлой/тёмной темы.
- Юнит-тесты vitest для утилит форматирования рейтинга и сортировки.

## Быстрый старт

```bash
npm install
npm run dev
```

По умолчанию Vite запускает сервер на `http://localhost:5173`. Для тестирования в окружении Telegram WebView добавьте приложение в Mini App и используйте HTTPS (`npm run dev:https`).

### Скрипты

| Скрипт             | Назначение |
|--------------------|------------|
| `npm run dev`      | Запуск dev-сервера Vite. |
| `npm run dev:https`| Запуск dev-сервера c локальным HTTPS (требует `mkcert`). |
| `npm run build`    | Проверка типов и production-сборка. |
| `npm run preview`  | Предпросмотр собранного приложения. |
| `npm run test`     | Запуск vitest. |
| `npm run lint`     | Проверка eslint. |

## Структура

```
src/
  app/             # App.tsx, роутер и провайдеры Mini App/темы
  entities/        # Бизнес-сущности: книги, категории
  pages/           # Страницы роутинга
  widgets/         # Крупные UI-блоки (хедер, фильтры, отзывы, карусель)
  shared/          # Общие хуки, утилиты, UI-атомы
  mocks/           # JSON-данные для Catalog API
```

## Тесты

```bash
npm run test
```

Используется [Vitest](https://vitest.dev/) и jsdom. Покрыты функции форматирования рейтинга и сортировки книг.

## TON Connect

Для демонстрации работы `@tonconnect/ui-react` в `public/tonconnect-manifest.json` лежит тестовый манифест. Кнопка «Подключить кошелёк» в шапке открывает заглушку выбора кошелька и показывает тост о подключении.

## Настройка Telegram SDK

`TMAProvider` при старте вызывает `expand`, монтирует BackButton и Viewport, применяет цвета из `themeParams` и автоматически скрывает BackButton на главном экране. Если приложение открыто вне Telegram, выводится баннер «демо-режим».

## Лицензия

Проект распространяется под лицензией MIT. Свободно используйте код в своих Mini Apps.
